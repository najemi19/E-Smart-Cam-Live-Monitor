# 📹 E‑Smart Cam Monitor

**PWA متكاملة لمراقبة الكاميرات** مع بث HLS/LL‑HLS، تحكم لحظي عبر WebSocket، وضع توفير البيانات، مؤشرات حالة، إشعارات، وسجل أحداث مع تصدير وفلترة.

---

## 📂 هيكل المشروع

project/ │ ├── package.json # تعريف المشروع والمكتبات ├── .env # إعدادات البيئة (المنفذ، سر التوقيع، مدة صلاحية الروابط) ├── cameras.json # ملف إعدادات الكاميرات ├── token.js # دوال توقيع والتحقق من الروابط الموقّتة ├── server.js # خادم Express + WebSocket + إدارة FFmpeg ├── start_streams.sh # سكربت ذكي لتشغيل كل الكاميرات من ملف الإعدادات └── public/ ├── index.html # الواجهة الموحدة (PWA) ├── streams/ # مجلد ملفات البث (يُنشأ تلقائيًا) └── snapshots/ # مجلد لقطات الصور (يُنشأ تلقائيًا)

---

## ⚙️ المتطلبات

- Node.js 18 أو أحدث
- FFmpeg مثبت على النظام
- أداة `jq` (لقراءة JSON في السكربت)
- روابط RTSP صالحة لكل كاميرا

---

## 🚀 التثبيت والتشغيل

1. **تثبيت المكتبات**
   ```bash
   npm install
[
  {
    "name": "cam1",
    "label": "كاميرا المدخل",
    "rtsp": "rtsp://USER:PASS@CAM1_IP:554/stream",
    "mode": "hls"
  }
]
npm start
node server.js
chmod +x start_streams.sh
./start_streams.sh
http://localhost:8080

🎯 الميزات
بث HLS وLL‑HLS مع حماية الروابط الموقّتة.

وضع توفير البيانات (لقطات صور بدلاً من الفيديو).

تحكم لحظي عبر WebSocket مع احتياطي HTTP.

مؤشرات حالة مباشرة (🟢/🔴) لكل كاميرا.

أزرار تشغيل/إيقاف داخل المشغل نفسه.

إشعارات منبثقة عند أي تغيير حالة.

سجل أحداث حيّ مع:

فلترة حسب النوع (تشغيل/إيقاف/معلومات).

مسح السجل.

تصدير السجل كملف CSV.

PWA قابلة للتثبيت مع Service Worker وManifest ديناميكي.

🛠️ ملاحظات
تأكد من أن FFmpeg يستطيع الوصول إلى روابط RTSP الخاصة بك.

إذا أردت تشغيل المشروع على سيرفر بعيد، افتح المنفذ المحدد في .env في جدار الحماية.

يمكن تعديل السكربت start_streams.sh لتغيير إعدادات البث أو إضافة معالجات إضافية.



---
مشروع خاص بـ E‑Smart — جميع الحقوق محفوظة.


بهذا الـ README سيكون أي شخص (أو أنت مستقبلًا) قادر على تشغيل المشروع وفهمه بسرعة.  
إذا أردت، أقدر أضيف لك **صور لواجهة التطبيق** داخل الـ README لزيادة الوضوح. هل تريد أن أضيف هذه الصور التوضيحية أيضًا؟
